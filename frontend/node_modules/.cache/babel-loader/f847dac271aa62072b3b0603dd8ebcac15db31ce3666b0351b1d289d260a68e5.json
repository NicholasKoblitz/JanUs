{"ast":null,"code":"import _objectSpread from\"/home/n/repos/JanUs/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useState,useRef}from\"react\";import{useNavigate}from\"react-router-dom\";import{Janus}from'../api';import UserContext from\"./UserContext\";import'../styles/LoginForm.css';import Navbar from\"./Navbar\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const LoginForm=()=>{const INIT_STATE={username:\"\",password:\"\"};const[formData,setFormData]=useState(INIT_STATE);let error=useRef();const{setUser}=useContext(UserContext);const navigate=useNavigate();const login=async()=>{let res=await Janus.login(formData);if(res.status===401){error.current=res.message;}else{error.current=null;let{token,isTeacher,firstName}=res;setUser(formData.username);localStorage.setItem(\"token\",token);localStorage.setItem(\"currentUser\",formData.username);localStorage.setItem(\"uid\",firstName);if(isTeacher)localStorage.setItem(\"isTeacher\",isTeacher);navigate(\"/users/\".concat(formData.username));}};let errorDiv=error.current?/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:/*#__PURE__*/_jsx(\"span\",{children:error.current})}):null;const handleChange=e=>{const{name,value}=e.target;setFormData(formData=>_objectSpread(_objectSpread({},formData),{},{[name]:value}));};const handleSubmit=async e=>{e.preventDefault();await login();setFormData(INIT_STATE);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"LoginForm\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"LoginForm-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:formData.username,onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:formData.password,onChange:handleChange}),errorDiv,/*#__PURE__*/_jsx(\"button\",{children:\"Login\"})]})]})]});};export default LoginForm;","map":{"version":3,"names":["React","useContext","useState","useRef","useNavigate","Janus","UserContext","Navbar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginForm","INIT_STATE","username","password","formData","setFormData","error","setUser","navigate","login","res","status","current","message","token","isTeacher","firstName","localStorage","setItem","concat","errorDiv","className","children","handleChange","e","name","value","target","_objectSpread","handleSubmit","preventDefault","onSubmit","htmlFor","type","onChange"],"sources":["/home/n/repos/JanUs/frontend/src/components/LoginForm.js"],"sourcesContent":["import React, {useContext, useState, useRef} from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport {Janus} from '../api';\nimport UserContext from \"./UserContext\";\nimport '../styles/LoginForm.css'\nimport Navbar from \"./Navbar\";\n\n\nconst LoginForm = () => {\n\n    const INIT_STATE = {\n        username: \"\",\n        password: \"\"\n    }\n\n    const [formData, setFormData] = useState(INIT_STATE);\n    let error = useRef();\n    const {setUser} = useContext(UserContext)\n    const navigate = useNavigate();\n\n\n    const login = async () => {\n        let res = await Janus.login(formData);\n        if(res.status === 401) {\n            error.current = res.message;\n        }\n        else{\n            error.current = null;\n            let {token, isTeacher, firstName} = res;\n            setUser(formData.username); \n            localStorage.setItem(\"token\", token);\n            localStorage.setItem(\"currentUser\", formData.username);\n            localStorage.setItem(\"uid\", firstName);\n            if(isTeacher) localStorage.setItem(\"isTeacher\", isTeacher);\n            navigate(`/users/${formData.username}`);\n        } \n    }\n\n\n    let errorDiv = error.current ? \n        <div className=\"error\">\n            <span>{error.current}</span>\n        </div>\n        :\n        null;\n\n    const handleChange = (e) => {\n        const {name, value} = e.target;\n        setFormData(formData => ({\n            ...formData,\n            [name]: value\n        }))\n    }\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        await login();\n        setFormData(INIT_STATE);\n    }\n\n\n    return (\n        <>\n            <Navbar/>\n            <div className=\"LoginForm\">\n                <h1>Login</h1>\n            <form className=\"LoginForm-form\" onSubmit={handleSubmit}>\n            <label htmlFor=\"username\">Username</label>\n                <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={formData.username}\n                    onChange={handleChange}\n                />\n                <label htmlFor=\"password\">Password</label>\n                <input\n                    type=\"password\"\n                    name=\"password\"\n                    value={formData.password}\n                    onChange={handleChange}\n                />\n                {errorDiv}\n                <button>Login</button>\n            </form>\n        </div>\n        </>\n        \n    )\n\n}\n\nexport default LoginForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}